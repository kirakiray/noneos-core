<template page>
  <l-m src="../../file-list/file-list.html"></l-m>
  <style>
    :host {
      display: block;
      height: 100%;
    }
  </style>

  <o-provider
    name="studio-data"
    :project-path="projectPath"
    :active-path="activePath"
    on:preview-file="previewFile"
  >
    <n-file-list
      on:contextmenu-item="contextmenuItem"
      style="padding-left: 8px"
    ></n-file-list>
  </o-provider>

  <script>
    export const parent = "./layout.html";

    export default async ({ load, query }) => {
      return {
        data: {
          projectPath: query.path,
          activePath: "",
        },
        proto: {
          async contextmenuItem(e) {
            debugger;
          },
          previewFile(e) {
            const { path } = e.data;

            window.open(`/${path}`);
          },
        },
        attached() {
          this.emit("active-page", {
            composed: true,
            data: {
              name: "files",
            },
          });
        },
      };
    };
  </script>
</template>
