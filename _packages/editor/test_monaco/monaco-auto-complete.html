<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Monaco Editor - è‡ªå®šä¹‰ä»£ç è¡¥å…¨</title>
    <style>
      #container {
        height: 600px;
        border: 1px solid #ccc;
      }
      .info {
        padding: 10px;
        background: #f0f0f0;
        margin-bottom: 10px;
      }
      code {
        background: #ddd;
        padding: 2px 4px;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <div class="info">
      <strong>æç¤ºï¼š</strong>è¾“å…¥ <code>html5</code> æˆ–
      <code>!</code> è¯•è¯•è‡ªå®šä¹‰ä»£ç ç‰‡æ®µè¡¥å…¨ï¼
    </div>
    <div id="container"></div>

    <script type="module">
      import * as monaco from "https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/+esm";

      // åˆ›å»ºç¼–è¾‘å™¨
      const editor = monaco.editor.create(
        document.getElementById("container"),
        {
          language: "html",
          theme: "vs-dark",
          tabSize: 2,
          insertSpaces: true,
          fontSize: 14,
          automaticLayout: true,
          wordWrap: "on",
        }
      );

      // è®¾ç½®åˆå§‹å†…å®¹
      editor.setValue("<!-- è¾“å…¥ html5 æˆ– ! è§¦å‘ä»£ç è¡¥å…¨ -->\n");

      // ==================== æ–¹æ¡ˆ1ï¼šç®€å•çš„ä»£ç ç‰‡æ®µè¡¥å…¨ ====================
      monaco.languages.registerCompletionItemProvider("html", {
        provideCompletionItems: function (model, position) {
          // è·å–å½“å‰è¡Œçš„å†…å®¹ç›´åˆ°å…‰æ ‡ä½ç½®
          const lineContent = model.getValueInRange({
            startLineNumber: position.lineNumber,
            startColumn: 1,
            endLineNumber: position.lineNumber,
            endColumn: position.column,
          });

          // å¦‚æœè¡Œé¦–æ˜¯ ! æˆ–è€… htmlï¼Œæä¾›HTML5æ¨¡æ¿è¡¥å…¨
          if (
            lineContent.trim() === "!" ||
            lineContent.trim().toLowerCase() === "html"
          ) {
            return {
              suggestions: [
                {
                  label: "html5-template",
                  kind: monaco.languages.CompletionItemKind.Snippet,
                  documentation: "HTML5 æ ‡å‡†æ¨¡æ¿",
                  insertText: `<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>\${1:Document}</title>
</head>
<body>
  \${0}
</body>
</html>`,
                  insertTextRules:
                    monaco.languages.CompletionItemInsertTextRule
                      .InsertAsSnippet,
                  range: {
                    startLineNumber: position.lineNumber,
                    endLineNumber: position.lineNumber,
                    startColumn: 1,
                    endColumn: position.column,
                  },
                },
              ],
            };
          }

          return { suggestions: [] };
        },
        triggerCharacters: ["!", "h"],
      });

      // ==================== æ–¹æ¡ˆ2ï¼šæ›´ä¸°å¯Œçš„HTMLæ ‡ç­¾è¡¥å…¨ ====================
//       monaco.languages.registerCompletionItemProvider("html", {
//         provideCompletionItems: function (model, position) {
//           const suggestions = [
//             // å¸¸ç”¨HTMLç»“æ„
//             {
//               label: "html5-boilerplate",
//               kind: monaco.languages.CompletionItemKind.Snippet,
//               documentation: "å®Œæ•´çš„HTML5æ¨¡æ¿",
//               insertText: `<!DOCTYPE html>
// <html lang="zh-CN">
// <head>
//   <meta charset="UTF-8">
//   <meta name="viewport" content="width=device-width, initial-scale=1.0">
//   <meta http-equiv="X-UA-Compatible" content="ie=edge">
//   <title>\${1:é¡µé¢æ ‡é¢˜}</title>
//   <style>
//     \${2}
//   </style>
// </head>
// <body>
//   <header>
//     <h1>\${3:ä¸»æ ‡é¢˜}</h1>
//   </header>
//   <main>
//     \${0}
//   </main>
//   <footer>
//     <p>&copy; 2024 \${4:å…¬å¸åç§°}</p>
//   </footer>
// </body>
// </html>`,
//               insertTextRules:
//                 monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
//             },
//             {
//               label: "form-basic",
//               kind: monaco.languages.CompletionItemKind.Snippet,
//               documentation: "åŸºç¡€è¡¨å•ç»“æ„",
//               insertText: `<form action="\${1:/submit}" method="\${2|get,post|}">
//   <div class="form-group">
//     <label for="\${3:username}">ç”¨æˆ·åï¼š</label>
//     <input type="text" id="\${3}" name="\${3}" class="form-control" required>
//   </div>
//   \${0}
//   <button type="submit" class="btn btn-primary">æäº¤</button>
// </form>`,
//               insertTextRules:
//                 monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
//             },
//             {
//               label: "table-responsive",
//               kind: monaco.languages.CompletionItemKind.Snippet,
//               documentation: "å“åº”å¼è¡¨æ ¼",
//               insertText: `<div class="table-responsive">
//   <table class="table table-striped table-bordered">
//     <thead>
//       <tr>
//         <th>\${1:åˆ—1}</th>
//         <th>\${2:åˆ—2}</th>
//         <th>\${3:åˆ—3}</th>
//       </tr>
//     </thead>
//     <tbody>
//       <tr>
//         <td>\${0:æ•°æ®}</td>
//         <td></td>
//         <td></td>
//       </tr>
//     </tbody>
//   </table>
// </div>`,
//               insertTextRules:
//                 monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
//             },
//           ];

//           return { suggestions: suggestions };
//         },
//         triggerCharacters: [">"],
//       });

      // ==================== æ–¹æ¡ˆ3ï¼šBootstrap ç»„ä»¶è¡¥å…¨ ====================
      monaco.languages.registerCompletionItemProvider("html", {
        provideCompletionItems: function (model, position) {
          const bootstrapComponents = [
            {
              label: "bs-button",
              kind: monaco.languages.CompletionItemKind.Snippet,
              documentation: "Bootstrap æŒ‰é’®",
              insertText: `<button type="button" class="btn btn-\${1|primary,secondary,success,danger,warning,info,light,dark|}">\${2:æŒ‰é’®æ–‡æœ¬}</button>\${0}`,
              insertTextRules:
                monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
            },
            {
              label: "bs-card",
              kind: monaco.languages.CompletionItemKind.Snippet,
              documentation: "Bootstrap å¡ç‰‡",
              insertText: `<div class="card" style="width: 18rem;">
  <img src="\${1:https://via.placeholder.com/150}" class="card-img-top" alt="\${2:å›¾ç‰‡}">
  <div class="card-body">
    <h5 class="card-title">\${3:æ ‡é¢˜}</h5>
    <p class="card-text">\${4:æ–‡æœ¬å†…å®¹}</p>
    <a href="\${5:#}" class="btn btn-primary">\${6:æŒ‰é’®}</a>
  </div>
</div>\${0}`,
              insertTextRules:
                monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
            },
            {
              label: "bs-navbar",
              kind: monaco.languages.CompletionItemKind.Snippet,
              documentation: "Bootstrap å¯¼èˆªæ ",
              insertText: `<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="\${1:#}">\${2:å“ç‰Œ}</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" href="\${3:#}">é¦–é¡µ</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="\${4:#}">åŠŸèƒ½</a>
        </li>
        \${0}
      </ul>
    </div>
  </div>
</nav>`,
              insertTextRules:
                monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
            },
          ];

          return { suggestions: bootstrapComponents };
        },
      });

      console.log("âœ… è‡ªå®šä¹‰ä»£ç è¡¥å…¨åŠŸèƒ½å·²åŠ è½½ï¼");
      console.log("ğŸ“‹ æ”¯æŒçš„ä»£ç ç‰‡æ®µï¼š");
      console.log("   - ! æˆ– html: å¿«é€Ÿæ’å…¥HTML5æ¨¡æ¿");
      console.log("   - html5-boilerplate: å®Œæ•´HTML5æ¨¡æ¿");
      console.log("   - form-basic: åŸºç¡€è¡¨å•");
      console.log("   - table-responsive: å“åº”å¼è¡¨æ ¼");
      console.log("   - bs-button: BootstrapæŒ‰é’®");
      console.log("   - bs-card: Bootstrapå¡ç‰‡");
      console.log("   - bs-navbar: Bootstrapå¯¼èˆªæ ");
    </script>
  </body>
</html>
