{"version":3,"file":"sw.js","sources":["sw/fs.js","sw/get-by-platform.js","sw/main.js"],"sourcesContent":["export const get = ({ request, path }) => {\n  console.log(request, path, 3);\n  return fetch(request);\n};\n","// 从 GitHub 仓库获取文件\nexport const getByGh = async ({ path }) => {\n  const rePath = path.replace(/^\\/\\$gh\\//, \"https://cdn.jsdelivr.net/gh/\");\n  console.log(\"gh: \", rePath);\n  const response = await fetch(rePath);\n\n  // 获取文本内容\n  const text = await response.text();\n\n  // 转化为新的 Response 对象\n  const newResponse = new Response(text, response);\n\n  return newResponse;\n};\n","import { get } from \"./fs.js\";\nimport { getByGh } from \"./get-by-platform.js\";\n\nself.addEventListener(\"fetch\", (event) => {\n  const { request } = event;\n  const { pathname } = new URL(request.url);\n\n  console.log(\"pathname: \", pathname);\n\n  if (/^\\/_/.test(pathname)) {\n    // 隐藏目录开头的，属于本地文件，无需代理\n    return;\n  }\n\n  if (/^\\/\\$gh/.test(pathname)) {\n    // 从 GitHub 仓库获取文件\n    return event.respondWith(\n      getByGh({\n        path: pathname,\n        originUrl: request.url,\n      })\n    );\n  }\n\n  event.respondWith(\n    get({\n      request,\n      originUrl: request.url,\n      path: pathname,\n    })\n  );\n});\n\nself.addEventListener(\"install\", () => {\n  self.skipWaiting();\n  console.log(\"NoneOS installation successful\");\n});\n\nself.addEventListener(\"activate\", () => {\n  self.clients.claim();\n  console.log(\"NoneOS server activation successful\");\n});\n"],"names":[],"mappings":";;;EAAO,MAAM,GAAG,GAAG,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK;EAC1C,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;EAChC,EAAE,OAAO,KAAK,CAAC,OAAO,CAAC,CAAC;EACxB,CAAC;;ECHD;EACO,MAAM,OAAO,GAAG,OAAO,EAAE,IAAI,EAAE,KAAK;EAC3C,EAAE,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,8BAA8B,CAAC,CAAC;EAC3E,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;EAC9B,EAAE,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,MAAM,CAAC,CAAC;AACvC;EACA;EACA,EAAE,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;AACrC;EACA;EACA,EAAE,MAAM,WAAW,GAAG,IAAI,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AACnD;EACA,EAAE,OAAO,WAAW,CAAC;EACrB,CAAC;;ECVD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,KAAK,KAAK;EAC1C,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,KAAK,CAAC;EAC5B,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;AAC5C;EACA,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;AACtC;EACA,EAAE,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;EAC7B;EACA,IAAI,OAAO;EACX,GAAG;AACH;EACA,EAAE,IAAI,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;EAChC;EACA,IAAI,OAAO,KAAK,CAAC,WAAW;EAC5B,MAAM,OAAO,CAAC;EACd,QAAQ,IAAI,EAAE,QAAQ;EACtB,QAAQ,SAAS,EAAE,OAAO,CAAC,GAAG;EAC9B,OAAO,CAAC;EACR,KAAK,CAAC;EACN,GAAG;AACH;EACA,EAAE,KAAK,CAAC,WAAW;EACnB,IAAI,GAAG,CAAC;EACR,MAAM,OAAO;EACb,MAAM,SAAS,EAAE,OAAO,CAAC,GAAG;EAC5B,MAAM,IAAI,EAAE,QAAQ;EACpB,KAAK,CAAC;EACN,GAAG,CAAC;EACJ,CAAC,CAAC,CAAC;AACH;EACA,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM;EACvC,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC;EACrB,EAAE,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;EAChD,CAAC,CAAC,CAAC;AACH;EACA,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM;EACxC,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;EACvB,EAAE,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;EACrD,CAAC,CAAC;;;;;;"}